<!DOCTYPE html>
<html lang="zh">
<head>
  <!-- 引入衬线字体-->
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Noto+Serif+SC:wght@600&display=swap" rel="stylesheet">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malaysia Crude Oil Trade — 2023</title>

  <!-- Vega 技术栈（顺序：vega -> vega-lite -> vega-embed） -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- 你的嵌图脚本：保持使用原来的 vega_lite_vis.js（ID 不变） -->
  <script defer src="vega_lite_vis.js"></script>

  <style>
    :root{
      /* ======== 尺寸控制：只改这里就能统一改大小 ======== */
      --max-page: 1100px;   /* 页面内容的最大宽度 */
      --map-max: 1100px;    /* 顶部地图的最大宽度 */
      --area-max: 820px;    /* 面积图的最大宽度（避免横向滚动） */
      --bars-max: 520px;    /* 两个 Top-15 条形图的最大宽度 */

      /* 左图右文列宽比例（大屏）：左 1.3 : 右 0.7，可按需改成 1.2/.8 等 */
      --cols-left: 1.35fr;
      --cols-right: .65fr;

      /* 颜色/排版（可选） */
      --ink: #0a2540;
      --text:#28354a;
      --muted:#617086;
      --line:#e7eef7;
      --bg:#fbfdff;
    }

    /* 全局文字与背景 */
    html,body{
      margin:0; padding:0;
      background:var(--bg); color:var(--text);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }
    h1,h2,h3{color:var(--ink); margin:0 0 10px;}
    p{line-height:1.65; margin:0 0 12px;}

    /* 页面包裹层：统一左右留白与最大宽 */
    .wrap{max-width:var(--max-page); margin:0 auto; padding:16px;}

    /* 分段：上边框做轻微分割 */
    .section{margin:18px 0 28px; border-top:1px solid var(--line); padding-top:18px;}

    /* 顶部地图：独占整行；宽度由 --map-max 控制 */
    .viz--map{max-width: var(--map-max); margin: 8px auto;}

    /* 两列布局（左图右文） */
    .row{
      display:grid; gap:20px; align-items:start;
      grid-template-columns: var(--cols-left) var(--cols-right); /* 由变量控制比例 */
    }

    /* 图表容器：禁止页面级横向滚动 */
    .viz{width:100%; overflow-x:auto;}

    /* 单独限制每类图的最大宽度（不改 JSON 就能控宽） */
    .viz--area { max-width: var(--area-max); }
    .viz--bars { max-width: var(--bars-max); }

    .aside{font-size:15px;}
    .aside .note{color:var(--muted); font-size:14px; margin-top:6px;}



    /* 仅在条形图那两行放大图，去掉 520px 上限 */
    .row--barsWide .viz--bars { max-width: none; }   /* 或写 100% 也行 */
    .row--barsWide { grid-template-columns: 1.5fr .5fr; }  /* 想更夸张就 1.8 : .2 */


    /* 响应式：小屏一列 */
    @media (max-width: 900px){
      .row{grid-template-columns: 1fr; gap:12px;}
      .viz--bars{max-width: 100%;}  /* 小屏条形图放宽 */
    }

    header h1{
    font-family: "Merriweather","Noto Serif SC", serif;
    font-weight: 900;                     /* 该字体的最大常见权重 */
    font-size: clamp(28px, 3.2vw, 44px);  /* 响应式字号：小屏28，大屏最多44 */
    text-align: center;
    line-height: 1.2;                     /* 让行距更紧凑些，可选 */
  }

    h2{
    font-family: "Merriweather","Noto Serif SC", serif;
    font-weight: 700;
    font-size: clamp(18px, 2.2vw, 28px);
    line-height: 1.3;
    text-align: center;
  }



  </style>
</head>
<body>

  <div class="wrap">
    <!-- 页面标题 -->
    <header style="margin:8px 0 12px;">
      <h1>Malaysia Crude Oil: Exports & Imports</h1>
    </header>

    <!-- 顶部地图（独占整行） -->
    <section class="section" id="sec-map">
      <h2>Export Partners — Geography (2023)</h2>
      <!-- ⚠️ ID 不要改：vega_lite_vis.js 里用 #export_map 挂载 -->
      <div id="export_map" class="viz viz--map"></div>
      <p class="note" style="color:var(--muted); font-size:14px;">
        说明：悬停查看国家与金额；Equal Earth 投影；单位 USD。
      </p>
    </section>

    <!-- 面积图 + 文字（左图右文） -->
    <section class="section" id="sec-area">
      <h2>Annual Crude Oil Imports and Exports</h2>
      <div class="row">
        <div class="viz viz--area">
          <!-- ⚠️ ID 不要改：#viz_trade_area -->
          <div id="viz_trade_area"></div>
        </div>
        <aside class="aside">
          <h3>Trend Observation</h3>
          <p>COVID-19 caused a sharp decline in crude oil imports and exports in 2022.</p>
          <p>Exports exceeded imports until 2022</p>
          <p>Reasons for the Crude Oil Trade Deficit：</p>
          <P>Weaker domestic output: mature field decline and maintenance reduce exportable crude.</P>
          <P>Geopolitics & pricing: post Russia–Ukraine, more discounted barrels in Asia → imports more economical.</P>
          <P>Structural shift: more “import crude → refine → export products,” so crude exports fall relative to imports.</P>
          
        </aside>
      </div>
    </section>

    <!-- 出口 Top-15 + 文字 -->
    <section class="section" id="sec-exports">
      <h2>Structure of Importing Countries and Export Destinations</h2>
        <div class="row row--barsWide"> 
        <div class="viz viz--bars">
          <h3>Top 15 Export Partners (2023)</h3>
          <div id="exports_top_bars_2023"></div>
        </div>
        <aside class="aside">
          <h3>Export Structure</h3>
          <p>Highly concentrated: China ≈ US$19B (~69%) of Top-15 exports; Top 5 buyers ≈ 95%.</p>
          <p>Portfolio is APAC-centric (China, Australia, Thailand, India, Brunei) → exposure to single-market & route risks (South China Sea/Malacca).</p>
          <p>Priorities: diversify buyers (India/Japan/Korea/ASEAN), mix term + spot contracts, and move up the value chain (refined products/petchem feedstocks).</p>
        </aside>
      </div>
    </section>

    <!-- 进口 Top-15 + 文字 -->
    <section class="section" id="sec-imports">
        <div class="row row--barsWide">
        <div class="viz viz--bars">
          <h3>Top 15 Import Sources (2023)</h3>
          <div id="imports_top_bars_2023"></div>
        </div>
        <aside class="aside">
          <h3>Import Structure</h3>
          <p>• 主要来源集中在中东；其次为非洲与美洲。</p>
          <p>• 与出口去向对比，体现“来源—去向”的地域差别。</p>
        </aside>
      </div>
    </section>


    <!-- 价格 ← 体积（联动刷选） | 占满整行 -->
    <section class="section" id="sec-link">
      <h2></h2>
      <h3>Crude Price vs Malaysia Export Volume (Linked Brush)</h3>

      <!-- 整行图表容器：不走两列布局 -->
      <div id="export_vs_production" class="viz" style="max-width: var(--max-page); margin: 0 auto;"></div>

      <!-- 说明文字：放在图下方 -->
      <div class="aside" style="max-width: 800px; margin: 10px 0 0 0; text-align: left;">
        <h3>马来西亚石油出口量如何影响国际油价？（撰写建议）</h3>
        <p>• 拖动下方“出口体积”时间窗，观察上方“国际油价”的同步变化。</p>
        <p>• 对比 2020 年、2022 年等时间段：出口体积增减与油价变动并非一一对应，提示全球供需与地缘事件更为主导。</p>
        <p>• 可结合 OPEC+ 政策、运输中断、需求冲击等外生因素，讨论出口量对价格的边际影响。</p>
      </div>
    </section>

  </div>
</body>
</html>

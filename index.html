<!DOCTYPE html>
<html lang="zh">
<head>
  <!-- 引入衬线字体-->
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Noto+Serif+SC:wght@600&display=swap" rel="stylesheet">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malaysia Crude Oil Trade — 2023</title>

  <!-- Vega 技术栈（顺序：vega -> vega-lite -> vega-embed） -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- 你的嵌图脚本：保持使用原来的 vega_lite_vis.js（ID 不变） -->
  <script defer src="vega_lite_vis.js"></script>

<!-- style 分割线-------style 分割线--------------style 分割线----------------style 分割线------------------style 分割线----------------- -->
  <style>
    :root{
      /* ======== 尺寸控制：只改这里就能统一改大小 ======== */
      --max-page: 1100px;   /* 页面内容的最大宽度 */
      --map-max: 1100px;    /* 顶部地图的最大宽度 */
      --area-max: 820px;    /* 面积图的最大宽度（避免横向滚动） */
      --bars-max: 520px;    /* 两个 Top-15 条形图的最大宽度 */

      /* 左图右文列宽比例（大屏）：左 1.3 : 右 0.7，可按需改成 1.2/.8 等 */
      --cols-left: 1.35fr;
      --cols-right: .65fr;

      /* 颜色/排版（可选） */
      --ink: #0a2540;
      --text:#28354a;
      --muted:#617086;
      --line:#e7eef7;
      --bg:#fbfdff;
    }

    /* 全局文字与背景 */
    html,body{
      margin:0; padding:0;
      background:var(--bg); color:var(--text);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }
    h1,h2,h3{color:var(--ink); margin:0 0 10px;}
    p{line-height:1.65; margin:0 0 12px;}

    /* 页面包裹层：统一左右留白与最大宽 */
    .wrap{max-width:var(--max-page); margin:0 auto; padding:16px;}

    /* 分段：上边框做轻微分割 */
    .section{margin:18px 0 28px; border-top:1px solid var(--line); padding-top:18px;}

    /* 顶部地图：独占整行；宽度由 --map-max 控制 */
    .viz--map{max-width: var(--map-max); margin: 8px auto;}

    /* 两列布局（左图右文） */
    .row{
      display:grid; gap:20px; align-items:start;
      grid-template-columns: var(--cols-left) var(--cols-right); /* 由变量控制比例 */
    }

    /* 图表容器：禁止页面级横向滚动 */
    .viz{width:100%; overflow-x:auto;}

    /* 单独限制每类图的最大宽度（不改 JSON 就能控宽） */
    .viz--area { max-width: var(--area-max); }
    .viz--bars { max-width: var(--bars-max); }

    .aside{font-size:15px;}
    .aside .note{color:var(--muted); font-size:14px; margin-top:6px;}



    /* 仅在条形图那两行放大图，去掉 520px 上限 */
    .row--barsWide .viz--bars { max-width: none; }   /* 或写 100% 也行 */
    .row--barsWide { grid-template-columns: 1.5fr .5fr; }  /* 想更夸张就 1.8 : .2 */


    /* 响应式：小屏一列 */
    @media (max-width: 900px){
      .row{grid-template-columns: 1fr; gap:12px;}
      .viz--bars{max-width: 100%;}  /* 小屏条形图放宽 */
    }

    header h1{
    font-family: "Merriweather","Noto Serif SC", serif;
    font-weight: 900;                     /* 该字体的最大常见权重 */
    font-size: clamp(28px, 3.2vw, 44px);  /* 响应式字号：小屏28，大屏最多44 */
    text-align: center;
    line-height: 2.0;                     /* 让行距更紧凑些，可选 */
  }

  :root{
    --h2-bg: #e9f0fe;      /* 浅色背景 */
    --h2-border: #e1e9f5;  /* 边框色 */
  }

  h2{
    background: var(--h2-bg);
    border: 1px solid var(--h2-border);
    display: inline-block;      /* 让背景只包住文字 */
    padding: 6px 14px;
    border-radius: 10px;
    box-shadow: 0 1px 0 rgba(10,37,64,.04);  /* 轻微立体感，可删 */
  }



      /* 三列信息块：左中右分布；小屏自动一列 */
    .tri-grid{
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;  /* 三列 */
      gap: 14px;                           /* 列间距 */
      margin-top: 10px;
    }
    .tri-card{
      background: #f6f9fc;   /* 轻灰底，和你的配色接近 */
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 12px 14px;
    }
    .tri-card h4{
      margin: 0 0 6px;
      font-size: 16px;
      color: var(--ink);
      font-weight: 700;
      font-family: "Merriweather","Noto Serif SC", serif; /* 和标题同风格 */
    }
    .tri-card p{
      margin: 0;
      font-size: 14px;
      line-height: 1.55;
      color: var(--text);
    }

    /* 小屏改为单列 */
    @media (max-width: 900px){
      .tri-grid{ grid-template-columns: 1fr; }
    }

  </style>
<!-- style 分割线-------style 分割线--------------style 分割线----------------style 分割线------------------style 分割线----------------- -->
</head>
<body>

  <div class="wrap">
    <!-- 页面标题 -->
    <header style="margin:8px 0 12px;">
      <h1>Malaysia Crude Oil: Exports & Imports</h1>
    </header>

    <!-- 顶部地图（独占整行） -->
    <section class="section" id="sec-map">
      <h2>Export Partners — Geography (2023)</h2>
      <!-- ⚠️ ID 不要改：vega_lite_vis.js 里用 #export_map 挂载 -->
      <div id="export_map" class="viz viz--map"></div>
    </section>

    <!-- 面积图 + 文字（左图右文） -->
    <section class="section" id="sec-area">
      <h2>Annual Crude Oil Imports and Exports</h2>
      <div class="row">
        <div class="viz viz--area">
          <!-- ⚠️ ID 不要改：#viz_trade_area -->
          <div id="viz_trade_area"></div>
        </div>
        <aside class="aside">
          <h3>Trend Observation</h3>
          <p>COVID-19 caused a sharp decline in crude oil imports and exports in 2022.</p>
          <p>Exports exceeded imports until 2022</p>
          <p>Reasons for the Crude Oil Trade Deficit：</p>
          <P>Weaker domestic output: mature field decline and maintenance reduce exportable crude.</P>
          <P>Geopolitics & pricing: post Russia–Ukraine, more discounted barrels in Asia → imports more economical.</P>
          <P>Structural shift: more “import crude → refine → export products,” so crude exports fall relative to imports.</P>
          
        </aside>
      </div>
    </section>

    <!-- 出口 Top-15 + 文字 -->
    <section class="section" id="sec-exports">
      <h2>Structure of Importing Countries and Export Destinations</h2>
        <div class="row row--barsWide"> 
        <div class="viz viz--bars">
          <h3>Top 15 Export Partners (2023)</h3>
          <div id="exports_top_bars_2023"></div>
        </div>
        <aside class="aside">
          <h3>Export Structure</h3>
          <p>Highly concentrated: China ≈ US$19B (~69%) of Top-15 exports; Top 5 buyers ≈ 95%.</p>
          <p>Portfolio is APAC-centric (China, Australia, Thailand, India, Brunei) → exposure to single-market & route risks (South China Sea/Malacca).</p>
          <p>Priorities: diversify buyers (India/Japan/Korea/ASEAN), mix term + spot contracts, and move up the value chain (refined products/petchem feedstocks).</p>
        </aside>
      </div>
    </section>

    <!-- 进口 Top-15 + 文字 -->
    <section class="section" id="sec-imports">
        <div class="row row--barsWide">
        <div class="viz viz--bars">
          <h3>Top 15 Import Sources (2023)</h3>
          <div id="imports_top_bars_2023"></div>
        </div>
        <aside class="aside">
          <h3>Import Structure</h3>
          <p>Highly concentrated: Saudi Arabia US$7.24B and UAE US$2.28B → Top-2 = ~66% of Top-15; Top-5 = ~81% (total ≈ US$14.46B)</p>
          <p>Supplier mix: Middle East–heavy (Saudi, UAE, Kuwait, Qatar, Oman), with secondary flows from Brazil/Angola/Gabon plus US & APAC (Australia, Thailand, Brunei).</p>
          <p>Implication: Strong reliance on Middle-East grades; Americas/Africa provide some diversification.</p>
        </aside>
      </div>
    </section>


    <!-- 产量 ← 体积（联动刷选） | 占满整行 -->
    <section class="section" id="sec-link">
      <h2>Relation Between Malaysia's Crude Oil Production and Exports</h2>

      <!-- 整行图表容器：不走两列布局 -->
      <div id="export_vs_production" class="viz" style="max-width: var(--max-page); margin: 0 auto;"></div>
      
      <!--灰色文字说明-->
      <p class="note" style="color:var(--muted); font-size:14px;">
        Note: The lower chart functions as an interactive filter for the upper chart.
    </p>

    <h3>How does Malaysia's oil production affect crude oil exports?</h3>


    <!--左中右三段式卡片文字说明-->
     <div class="tri-grid">
  <div class="tri-card">
    <h4>Same direction over time</h4>
    <p>Since 2016, due to declining crude oil production, the overall trend in export volumes has also been decreasing.</p>
  </div>

  <div class="tri-card">
    <h4>Turning points line up</h4>
    <p>In 2020, international oil prices plummeted, leading to a significant decline in both export volumes and oil production.</p>
  </div>

  <div class="tri-card">
    <h4>Lag effect</h4>
    <p>Malaysia’s oil exports follow production with a 1–2 month lag, as crude must be processed and shipped before export.</p>
  </div>
</div>

    </section>

  </div>
</body>
</html>

{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 550,
  "height": {"step": 16},
  "title": {"text": "Malaysia Crude Oil Imports by Exporter (2023) â€” Top 15"},
  "data": {
    "url": "https://raw.githubusercontent.com/ESPLORARE/FIT3179A2/refs/heads/main/importCountry.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"calculate": "toNumber(datum['Trade Value (USD)'])", "as": "Value_USD"},
    {"filter": "isValid(datum.Value_USD) && datum.Value_USD > 0"},
    {"calculate": "datum.Value_USD / 1e6", "as": "Value_MillionUSD"},
    {"window": [{"op":"rank","as":"r"}], "sort": [{"field":"Value_USD","order":"descending"}]},
    {"filter": "datum.r <= 15"}
  ],
  "layer": [
    {
      "mark": {"type":"bar", "cornerRadiusEnd": 3},
      "encoding": {
        "y": {"field": "Exporter Country", "type": "nominal", "sort": "-x", "title": null},
        "x": {
          "field": "Value_MillionUSD",
          "type": "quantitative",
          "scale": {"nice": true, "zero": true},
          "axis": {"title": "Imports (Million USD)", "format": ",.0f", "grid": true, "gridDash": [2,2]}
        },
        "color": {
          "condition": {"test": "datum.r==1", "value": "#AB3E0B"},
          "value": "#f2c9b6"
        },
        "tooltip": [
          {"field":"Exporter Country", "title":"Country"},
          {"field":"Value_USD","type":"quantitative","title":"Imports (USD)","format":","},
          {"field":"Value_MillionUSD","type":"quantitative","title":"Imports (Million USD)","format":",.0f"}
        ]
      }
    },
    {
      "mark": {"type":"text", "align":"left", "baseline":"middle", "dx": 4, "fontWeight": "600"},
      "encoding": {
        "y": {"field": "Exporter Country", "type": "nominal", "sort": "-x"},
        "x": {"field": "Value_MillionUSD", "type": "quantitative"},
        "text": {"field": "Value_MillionUSD", "type":"quantitative", "format": ",.0f"}
      }
    }
  ],
  "config": {"view": {"stroke": null}, "axis": {"labelFontSize": 11, "titleFontSize": 12}}
}
